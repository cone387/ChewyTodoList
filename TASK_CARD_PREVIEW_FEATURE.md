# 任务卡片预览功能

## 功能概述

为任务卡片样式系统添加了预览功能，用户可以在应用样式之前查看实际效果。采用简洁的单列表设计，在任务列表右上方显示当前卡片样式徽章。

## 新增页面

### 1. 任务卡片市场页面 (`TaskCardMarketPage`)
- **路由**: `/task-cards`
- **功能**: 
  - 展示所有可用的任务卡片样式模板
  - 显示每个样式的详细特性和配置
  - 提供预览和应用按钮
- **特点**:
  - 卡片式布局展示所有样式
  - 显示样式特性标签（布局、圆角、阴影等）
  - 样式详情网格展示（圆角、阴影、标题大小、复选框样式）

### 2. 任务卡片预览页面 (`TaskCardPreviewPage`)
- **路由**: `/task-card-preview?template={encodedTemplate}`
- **功能**:
  - 使用示例任务数据展示卡片样式的实际效果
  - 显示样式的特性标签
  - 提供返回和应用按钮
- **特点**:
  - 生成4个不同状态的示例任务（待办、进行中、已完成、逾期）
  - 实时渲染使用选定样式的任务列表
  - 包含已完成任务的折叠展示

## 入口点

### 1. 视图管理页面 (`ViewsPage`)
- 在header中添加了"卡片样式"按钮
- 图标: `style`
- 颜色: 蓝色主题

### 2. 首页 (`HomePage`)
- Header中已有的"任务卡片样式"按钮
- 任务卡片选择器采用简洁的单列表设计
- 底部新增"浏览更多卡片样式"按钮
- **任务列表右上方显示当前卡片样式徽章**（仅列表视图）

## UI设计

### 任务卡片选择器（首页弹窗）
- **布局**: 单列表设计，每个样式包含预览
- **样式卡片**: 
  - **头部区域**:
    - 显示图标、名称、描述
    - 特性标签（紧凑/舒适/宽松、描述、优先级等）
    - 选中状态带勾选图标
  - **预览区域**:
    - 实时显示该样式的任务卡片效果
    - 包含示例任务（标题、项目、日期、标签等）
    - 完整展示样式特性（圆角、阴影、布局等）
  - 支持点击选择、双击应用
- **底部操作**:
  - "浏览更多卡片样式"按钮（跳转到市场页面）
  - 提示信息和应用按钮

### 卡片样式徽章（任务列表）
- **位置**: 任务列表右上方
- **样式**: 
  - 圆角胶囊形状
  - 主题色背景（primary/10透明度）
  - 显示卡片图标和名称
  - 小巧精致，不占用太多空间
- **显示条件**: 仅在列表视图时显示

## 预览数据

预览页面使用以下示例任务：

1. **完成项目文档**
   - 状态: 待办
   - 优先级: 高
   - 截止日期: 2天后
   - 包含描述和子任务

2. **修复登录页面bug**
   - 状态: 进行中
   - 优先级: 紧急
   - 截止日期: 已逾期
   - 包含描述和子任务

3. **设计新功能原型**
   - 状态: 待办
   - 优先级: 中
   - 截止日期: 7天后
   - 包含描述

4. **团队周会准备**
   - 状态: 已完成
   - 优先级: 低
   - 截止日期: 今天
   - 包含子任务

## 用户流程

### 从首页访问
1. 点击Header中的"任务卡片样式"按钮
2. 在弹出的选择器中浏览样式（单列表）
3. 点击选择样式，双击直接应用
4. 或点击底部"浏览更多卡片样式"按钮
5. 进入任务卡片市场页面
6. 点击任意样式的"预览效果"按钮
7. 查看实际渲染效果
8. 点击"使用此样式"应用

### 从视图管理页面访问
1. 进入视图管理页面
2. 点击Header中的"卡片样式"按钮
3. 进入任务卡片市场页面
4. 后续流程同上

### 查看当前样式
- 在首页列表视图中，右上方显示当前使用的卡片样式徽章
- 徽章显示样式图标和名称
- 点击Header的卡片样式按钮可切换

## 技术实现

### 路由配置
```typescript
// App.tsx
<Route path="/task-cards" element={<ProtectedRoute><TaskCardMarketPage /></ProtectedRoute>} />
<Route path="/task-card-preview" element={<ProtectedRoute><TaskCardPreviewPage /></ProtectedRoute>} />
```

### 数据传递
- 使用URL参数传递模板数据
- 通过 `encodeURIComponent(JSON.stringify(template))` 编码
- 在预览页面解码并解析

### 样式应用
- 预览页面将 `TaskCardTemplate` 传递给 `EnhancedTaskList` 组件
- 组件根据模板配置动态应用样式
- 支持所有卡片样式配置项

### 卡片样式徽章
```typescript
{currentCardStyle && viewData.view_type === 'list' && (
  <div className="flex items-center justify-end mb-3 px-4">
    <div className="flex items-center gap-2 px-3 py-1.5 bg-primary/10 dark:bg-primary/20 rounded-full">
      <span className="material-symbols-outlined text-primary text-[14px]">
        {currentCardStyle.icon}
      </span>
      <span className="text-xs font-medium text-primary">
        {currentCardStyle.name}
      </span>
    </div>
  </div>
)}
```

## 可用的卡片样式

1. **默认卡片** - 简洁实用的默认样式
2. **极简卡片** - 最小化信息，专注任务本身
3. **详细卡片** - 显示完整的任务信息
4. **看板卡片** - 适合看板视图的紧凑样式
5. **彩色卡片** - 使用颜色突出优先级和状态
6. **时间线卡片** - 强调时间信息的卡片样式

## 设计优势

1. **所见即所得**: 每个样式直接显示预览效果，无需额外点击
2. **快速对比**: 滚动列表即可对比所有样式的视觉效果
3. **快速选择**: 点击选择，双击应用，操作流畅
4. **视觉反馈**: 徽章显示当前样式，一目了然
5. **空间利用**: 徽章小巧精致，不影响任务列表
6. **渐进增强**: 提供"浏览更多"入口，满足深度需求
7. **真实预览**: 使用实际的任务卡片组件渲染，确保预览准确

## 后续优化建议

1. **样式持久化**: 将用户选择的卡片样式保存到视图配置中
2. **自定义样式**: 允许用户创建和保存自定义卡片样式
3. **样式分享**: 支持导出和导入卡片样式配置
4. **更多预览数据**: 提供更多样化的示例任务数据
5. **实时编辑**: 在预览页面支持实时调整样式参数
6. **样式收藏**: 允许用户收藏喜欢的样式
7. **样式评分**: 添加用户评分和评论功能
8. **徽章交互**: 点击徽章快速打开样式选择器

## 相关文件

- `frontend/src/pages/TaskCardMarketPage.tsx` - 卡片市场页面
- `frontend/src/pages/TaskCardPreviewPage.tsx` - 卡片预览页面
- `frontend/src/types/taskCard.ts` - 卡片样式类型定义
- `frontend/src/components/EnhancedTaskList.tsx` - 任务列表组件（支持卡片样式）
- `frontend/src/App.tsx` - 路由配置
- `frontend/src/pages/ViewsPage.tsx` - 视图管理页面（入口）
- `frontend/src/pages/HomePage.tsx` - 首页（入口、徽章显示）
